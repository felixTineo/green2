{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useReducer } from 'react';\nimport './login.scss';\nimport Layout from '../components/layout/layout';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faGift } from '@fortawesome/free-solid-svg-icons';\nimport Logo from '../components/layout/logo';\nimport { TweenMax } from 'gsap';\nimport axios from 'axios';\nimport { useDispatch } from 'react-redux';\nimport { ON_LOADER } from '../store/actions';\nimport { Popover, PopoverBody } from 'reactstrap';\nimport Router from 'next/router';\nimport { ON_LOGIN } from '../store/actions';\n\nconst LoginForm = ({\n  setLogin\n}) => {\n  const {\n    0: mail,\n    1: setMail\n  } = useState('');\n  const {\n    0: pass,\n    1: setPass\n  } = useState('');\n  const {\n    0: popMail,\n    1: setPopMail\n  } = useState(false);\n  const {\n    0: popPass,\n    1: setPopPass\n  } = useState(false);\n  const {\n    0: active,\n    1: setActive\n  } = useState(false);\n  const dispatch = useDispatch();\n\n  const onSubmit = async e => {\n    try {\n      e.preventDefault();\n      let count = 0;\n      setActive(true);\n      let interval = setInterval(() => {\n        count = count + 15;\n\n        if (count >= 75) {\n          clearInterval(interval);\n          dispatch({\n            type: ON_LOADER,\n            loader: 99\n          });\n        } else {\n          dispatch({\n            type: ON_LOADER,\n            loader: count\n          });\n        }\n      }, 1000);\n      const data = {\n        mail,\n        pass\n      };\n      const res = await axios.post('/user/login', data);\n      clearInterval(interval);\n\n      if (res.data === 'mail') {\n        setActive(false);\n        dispatch({\n          type: ON_LOADER,\n          loader: 0\n        });\n        return setPopMail(true);\n      }\n\n      if (res.data === 'pass') {\n        setActive(false);\n        dispatch({\n          type: ON_LOADER,\n          loader: 0\n        });\n        return setPopPass(true);\n      }\n\n      dispatch({\n        type: ON_LOADER,\n        loader: 100\n      });\n      Router.push(`/perfil/${res.data}`);\n      dispatch({\n        type: ON_LOADER,\n        loader: 100\n      });\n    } catch (err) {\n      console.log(err);\n      dispatch({\n        type: ON_LOADER,\n        loader: 0\n      });\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"login_register_cont animated fadeIn\"\n  }, __jsx(\"header\", null, __jsx(\"h1\", null, \"Inicio de sessi\\xF3n\")), __jsx(\"form\", {\n    onSubmit: onSubmit\n  }, __jsx(\"label\", {\n    htmlFor: \"mail\"\n  }, __jsx(\"p\", null, \"usuario\"), __jsx(\"input\", {\n    disabled: active,\n    autoComplete: \"false\",\n    onBlur: () => setPopMail(false),\n    onFocus: () => setPopMail(false),\n    id: \"mail\",\n    value: mail,\n    onChange: e => setMail(e.currentTarget.value),\n    type: \"text\"\n  }), __jsx(Popover, {\n    isOpen: popMail,\n    target: \"mail\",\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"span\", null, \"El correo no es correcto, por favor verifiquelo e intentelo de nuevo\")))), __jsx(\"label\", {\n    htmlFor: \"pass\"\n  }, __jsx(\"p\", null, \"contrase\\xF1a\"), __jsx(\"input\", {\n    disabled: active,\n    onBlur: () => setPopPass(false),\n    onFocus: () => setPopPass(false),\n    id: \"pass\",\n    value: pass,\n    onChange: e => setPass(e.currentTarget.value),\n    type: \"password\"\n  }), __jsx(Popover, {\n    isOpen: popPass,\n    target: \"pass\",\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"span\", null, \"El correo no es correcto, por favor verifiquelo e intentelo de nuevo\")))), __jsx(\"footer\", {\n    className: \"login_register_cont\"\n  }, __jsx(\"button\", {\n    disabled: active,\n    onClick: () => setLogin(false),\n    className: \"btn_loogin_register btn_inactive\",\n    type: \"button\"\n  }, \"registro\"), __jsx(\"button\", {\n    disabled: active,\n    className: \"btn_loogin_register btn_active\",\n    type: \"submit\"\n  }, \"login\"))));\n};\n\nconst RegisterForm = ({\n  setLogin\n}) => {\n  const dispatch = useDispatch();\n  const {\n    0: mailPop,\n    1: setMailPop\n  } = useState();\n  const {\n    0: values,\n    1: setValues\n  } = useReducer((state, newState) => _objectSpread({}, state, newState), {\n    name: '',\n    lastName: '',\n    mail: '',\n    pass: '',\n    birthday: '',\n    sex: ''\n  });\n\n  const onSubmit = async e => {\n    try {\n      e.preventDefault();\n      let count = 0;\n      const interval = setInterval(() => {\n        count = count + 15;\n        dispatch({\n          type: ON_LOADER,\n          loader: count\n        });\n      }, 1000);\n      const data = {\n        name: values.name,\n        lastName: values.lastName,\n        mail: values.mail.toLocaleLowerCase(),\n        pass: values.pass,\n        birthday: values.birthday,\n        sex: values.sex\n      };\n      const res = await axios.post('/user/register', data);\n      clearInterval(interval);\n\n      if (res.data === 'mail') {\n        dispatch({\n          type: ON_LOADER,\n          loader: 0\n        });\n        setMailPop(true);\n      } else {\n        dispatch({\n          type: ON_LOADER,\n          loader: 100\n        });\n        console.log(res.data);\n        Router.push(`/perfil/${res.data}`);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"register_login_cont animated fadeIn\"\n  }, __jsx(\"header\", null, __jsx(\"h1\", null, \"registro\"), __jsx(\"p\", null, \"Gratis, facil y rapido\")), __jsx(\"form\", {\n    onSubmit: onSubmit\n  }, __jsx(\"div\", {\n    className: \"fullName\"\n  }, __jsx(\"input\", {\n    id: \"name\",\n    type: \"text\",\n    placeholder: \"Nombre\",\n    value: values.name,\n    onChange: e => setValues({\n      name: e.currentTarget.value\n    })\n  }), __jsx(\"input\", {\n    style: {\n      marginLeft: \".5rem\"\n    },\n    id: \"lastName\",\n    type: \"text\",\n    placeholder: \"Apellido\",\n    value: values.lastName,\n    onChange: e => setValues({\n      lastName: e.currentTarget.value\n    })\n  })), __jsx(\"input\", {\n    id: \"mail\",\n    type: \"text\",\n    placeholder: \"Correo electr\\xF3nico\",\n    value: values.mail,\n    onFocus: () => setMailPop(false),\n    onChange: e => setValues({\n      mail: e.currentTarget.value\n    })\n  }), __jsx(Popover, {\n    placement: \"bottom\",\n    target: \"mail\",\n    isOpen: mailPop\n  }, __jsx(PopoverBody, null, __jsx(\"span\", null, \"El correo ya fue usado para crear otra cuenta\"))), __jsx(\"input\", {\n    id: \"pass\",\n    type: \"password\",\n    placeholder: \"Contrase\\xF1a\",\n    value: values.pass,\n    onChange: e => setValues({\n      pass: e.currentTarget.value\n    })\n  }), __jsx(\"div\", {\n    className: \"birth_sex_main\"\n  }, __jsx(\"div\", {\n    className: \"birthday_sex\"\n  }, __jsx(\"p\", null, \"Cumplea\\xF1os\"), __jsx(\"input\", {\n    id: \"birthday\",\n    type: \"date\",\n    placeholder: \"Correo electr\\xF3nico\",\n    value: values.birthday,\n    onChange: e => setValues({\n      birthday: e.currentTarget.value\n    })\n  })), __jsx(\"div\", {\n    className: \"birthday_sex\",\n    style: {\n      marginLeft: '1rem'\n    }\n  }, __jsx(\"p\", null, \"Sexo\"), __jsx(\"select\", {\n    onChange: e => setValues({\n      sex: e.currentTarget.value\n    }),\n    name: \"sex\",\n    id: \"sex\"\n  }, __jsx(\"option\", {\n    value: \"female\"\n  }, \"Mujer\"), __jsx(\"option\", {\n    value: \"male\"\n  }, \"Hombre\"), __jsx(\"option\", {\n    value: \"otro\"\n  }, \"Otro\")))), __jsx(\"footer\", {\n    className: \"login_register_cont\"\n  }, __jsx(\"button\", {\n    className: \"btn_loogin_register btn_active\",\n    type: \"submit\"\n  }, \"registro\"), __jsx(\"button\", {\n    onClick: () => setLogin(true),\n    className: \"btn_loogin_register btn_inactive\",\n    type: \"button\"\n  }, \"login\"))));\n};\n\nconst Login = () => {\n  const {\n    0: login,\n    1: setLogin\n  } = useState(true);\n  return __jsx(Layout, null, __jsx(\"div\", {\n    className: \"login_main_cont\"\n  }, __jsx(\"div\", {\n    className: \"login_cont shadow\"\n  }, __jsx(\"div\", {\n    className: \"green_cont\"\n  }, __jsx(\"header\", null, __jsx(Logo, {\n    url: \"/\"\n  })), __jsx(\"div\", {\n    className: \"green_logo\"\n  }, __jsx(\"h1\", null, __jsx(FontAwesomeIcon, {\n    icon: faGift\n  })), __jsx(\"p\", null, \"Comparte, disfruta... Ayuda el planeta\"), __jsx(\"button\", {\n    type: \"button\"\n  }, \"\\xBFquieres saber mas?\")), __jsx(\"small\", null, \"Comparte con los seres que amas y ayuda a el planeta.\")), login && __jsx(LoginForm, {\n    setLogin: setLogin\n  }), !login && __jsx(RegisterForm, {\n    setLogin: setLogin\n  }))));\n};\n\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}