{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useCallback, useState } from 'react';\nimport Logo from './logo';\nimport Router from 'next/router';\nimport './header.scss';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch, faGift, faHeart, faUser, faCog, faCoins, faBell } from '@fortawesome/free-solid-svg-icons';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { navView, ON_VIEW_NAV, ON_LOADER, ON_NOTIFICATIONS, ON_LOGIN, OFF_FLOAT, ON_FLOAT, ON_GREEN_LIKE, ON_VAULT } from '../../store/actions';\nimport axios from 'axios';\nimport Link from 'next/link';\nimport { Popover, PopoverBody } from 'reactstrap';\nimport uuid from 'uuid/v1';\nimport io from 'socket.io-client';\nimport MyLink from '../mylink/link';\n\nconst DownBar = () => {\n  const {\n    0: down,\n    1: setDown\n  } = useState(false);\n  useEffect(() => {\n    window.onscroll = () => {\n      if (window.scrollY > 30) {\n        setDown(true);\n      } else {\n        setDown(false);\n      }\n    };\n  }, []);\n  const {\n    0: sm,\n    1: setSm\n  } = useState(false);\n  useEffect(() => {\n    if (window.innerWidth < 576) {\n      setSm(true);\n    }\n  }, []);\n  return __jsx(\"div\", {\n    className: \"down_bar\",\n    style: {\n      height: 40\n      /*down || sm ? 40 : 0*/\n\n    }\n  });\n};\n\nconst SearchBar = () => {\n  const {\n    0: suggest,\n    1: setSuggest\n  } = useState([]);\n  const {\n    0: visible,\n    1: setVisible\n  } = useState(false);\n\n  const onSuggest = async e => {\n    const value = e.target.value;\n\n    if (value) {\n      value.toLocaleLowerCase();\n      const res = await axios.get(`/user/search/${value}`);\n\n      if (res.data) {\n        console.log(res.data);\n        setVisible(true);\n        setSuggest(res.data);\n      }\n    } else {\n      setVisible(false);\n      setSuggest([]);\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"searchbar_main_cont\"\n  }, __jsx(\"div\", {\n    className: \"search_cont\"\n  }, __jsx(\"input\", {\n    onChange: onSuggest,\n    type: \"text\"\n  }), __jsx(\"p\", null, __jsx(FontAwesomeIcon, {\n    icon: faSearch\n  }))), visible && __jsx(\"ul\", {\n    style: {\n      padding: suggest.length > 0 ? '.2rem' : '0'\n    },\n    className: \"sugesstlist\"\n  }, suggest.map(item => __jsx(\"li\", {\n    key: uuid()\n  }, __jsx(MyLink, {\n    url: item.url,\n    callback: setVisible\n  }, __jsx(\"div\", {\n    className: \"user_search_cont\"\n  }, __jsx(\"img\", {\n    src: item.perfilImg,\n    alt: \"\"\n  }), __jsx(\"p\", null, item.fullName)))))));\n};\n\nconst Gift = () => {\n  const gifts = useSelector(state => state.nav.notifications.gifts);\n  const dispatch = useDispatch();\n  const onView = useCallback(() => {\n    dispatch({\n      type: ON_VIEW_NAV,\n      note: navView.GIFT\n    });\n    dispatch({\n      type: ON_VAULT\n    });\n  });\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"gift\",\n    onClick: onView,\n    style: !gifts.view && gifts.items.length > 0 ? {\n      background: \"#fff\",\n      color: \"#ff6c1a\"\n    } : {\n      background: \"transparent\",\n      color: \"#fff\"\n    },\n    className: \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faGift\n  })), __jsx(\"span\", {\n    style: !gifts.view && gifts.items.length > 0 ? {\n      color: \"#ff6c1a\"\n    } : {\n      color: \"#fff\"\n    }\n  }, \"+\", gifts.items.length));\n};\n\nconst Note = () => {\n  const notes = useSelector(state => state.nav.notifications.notes);\n  const dispatch = useDispatch();\n  const onView = useCallback(() => {\n    dispatch({\n      type: ON_VIEW_NAV,\n      note: navView.NOTES\n    });\n  });\n  const {\n    0: pop,\n    1: setPop\n  } = useState(false);\n\n  const handleView = () => {\n    onView();\n    setPop(!pop);\n  };\n\n  const handleViewOut = () => {\n    setPop(false);\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-1160065305\" + \" \" + \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"note\",\n    onClick: handleView,\n    style: !notes.view && notes.items.length > 0 ? {\n      background: \"#fff\",\n      color: \"#ff6c1a\"\n    } : {\n      background: \"transparent\",\n      color: \"#fff\"\n    },\n    className: \"jsx-1160065305\" + \" \" + \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faBell\n  })), __jsx(\"span\", {\n    style: !notes.view && notes.items.length > 0 ? {\n      color: \"#ff6c1a\"\n    } : {\n      color: \"#fff\"\n    },\n    className: \"jsx-1160065305\"\n  }, \"+\", notes.items.length), __jsx(Popover, {\n    target: \"note\",\n    isOpen: pop,\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"ul\", {\n    onClick: handleViewOut,\n    onMouseLeave: handleViewOut,\n    className: \"jsx-1160065305\"\n  }, notes.items.map(item => __jsx(\"li\", {\n    key: uuid(),\n    className: \"jsx-1160065305\"\n  }, __jsx(MyLink, {\n    url: item.url\n  }, __jsx(\"div\", {\n    className: \"jsx-1160065305\" + \" \" + \"friend_cont\"\n  }, __jsx(\"img\", {\n    src: item.perfilImg,\n    alt: \"\",\n    className: \"jsx-1160065305\"\n  }), __jsx(\"p\", {\n    className: \"jsx-1160065305\"\n  }, __jsx(\"strong\", {\n    className: \"jsx-1160065305\"\n  }, `${item.name} ${item.lastName}`), __jsx(\"small\", {\n    className: \"jsx-1160065305\"\n  }, item.action === 'LIKE' ? 'le gusta uno de tus posts' : item.action === 'ACCEPT' ? 'Acepto tu solicitud de amistad' : 'comento uno de tus posts'))))))))), __jsx(_JSXStyle, {\n    id: \"1160065305\"\n  }, [\"ul.jsx-1160065305{list-style:none;margin:0;padding:0;}\", \".friend_cont.jsx-1160065305{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:250ms ease;transition:250ms ease;}\", \".friend_cont.jsx-1160065305 p.jsx-1160065305{margin:0;margin-left:.5rem;text-transform:capitalize;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}\", \".friend_cont.jsx-1160065305 p.jsx-1160065305 strong.jsx-1160065305:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#8bb940;}\", \".friend_cont.jsx-1160065305 img.jsx-1160065305{width:40px;height:40px;object-fit:cover;object-position:center;border-radius:50%;}\"]));\n};\n\nconst Friend = () => {\n  const friend = useSelector(state => state.nav.notifications.friendReq);\n  const dispatch = useDispatch();\n  const onView = useCallback(() => {\n    dispatch({\n      type: ON_VIEW_NAV,\n      note: navView.FRIEND\n    });\n  });\n  const {\n    0: pop,\n    1: setPop\n  } = useState(false);\n\n  const handleView = () => {\n    onView();\n    setPop(!pop);\n  };\n\n  const handleViewOut = () => {\n    setPop(false);\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-1415226531\" + \" \" + \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"friend\",\n    onClick: handleView,\n    style: !friend.view && friend.items.length > 0 ? {\n      background: \"#fff\",\n      color: \"#ff6c1a\"\n    } : {\n      background: \"transparent\",\n      color: \"#fff\"\n    },\n    className: \"jsx-1415226531\" + \" \" + \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faUser\n  })), __jsx(\"span\", {\n    style: !friend.view && friend.items.length > 0 ? {\n      color: \"#ff6c1a\"\n    } : {\n      color: \"#fff\"\n    },\n    className: \"jsx-1415226531\"\n  }, \"+\", friend.items.length), __jsx(Popover, {\n    target: \"friend\",\n    isOpen: pop,\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"ul\", {\n    onMouseLeave: handleViewOut,\n    className: \"jsx-1415226531\"\n  }, friend.items.map(item => __jsx(\"li\", {\n    key: uuid(),\n    className: \"jsx-1415226531\"\n  }, __jsx(MyLink, {\n    url: item.url,\n    callback: () => null\n  }, __jsx(\"div\", {\n    className: \"jsx-1415226531\" + \" \" + \"friend_cont\"\n  }, __jsx(\"img\", {\n    src: item.perfilImg,\n    alt: \"\",\n    className: \"jsx-1415226531\"\n  }), __jsx(\"p\", {\n    className: \"jsx-1415226531\"\n  }, `${item.name} ${item.lastName}`)))))))), __jsx(_JSXStyle, {\n    id: \"1415226531\"\n  }, [\"ul.jsx-1415226531{list-style:none;margin:0;padding:0;}\", \".friend_cont.jsx-1415226531{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:250ms ease;transition:250ms ease;}\", \".friend_cont.jsx-1415226531 p.jsx-1415226531{margin:0;margin-left:.5rem;text-transform:capitalize;}\", \".friend_cont.jsx-1415226531 p.jsx-1415226531:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#8bb940;}\", \".friend_cont.jsx-1415226531 img.jsx-1415226531{width:40px;height:40px;object-fit:cover;object-position:center;border-radius:50%;}\"]));\n};\n\nconst Option = () => {\n  const {\n    0: pop,\n    1: setPop\n  } = useState(false);\n  const dispatch = useDispatch();\n  const id = useSelector(state => state.nav.notifications.id);\n  const onLogout = useCallback(async () => {\n    try {\n      await axios.get('/user/logout');\n      dispatch({\n        type: ON_LOGIN,\n        option: false\n      });\n      Router.push('/login');\n    } catch (err) {\n      console.log(err);\n    }\n  });\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"option\",\n    onClick: () => setPop(!pop),\n    className: \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faCog\n  })), __jsx(Popover, {\n    target: \"option\",\n    isOpen: pop,\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, {\n    style: {\n      padding: 0\n    }\n  }, __jsx(\"ul\", {\n    className: \"option_list\",\n    onMouseLeave: () => setPop(false)\n  }, __jsx(\"li\", null, __jsx(MyLink, {\n    url: `/perfil/${id}`,\n    callback: () => null\n  }, __jsx(\"p\", {\n    style: {\n      color: '#8bb940',\n      margin: 0\n    }\n  }, \"Perfil\"))), __jsx(\"li\", null, __jsx(\"button\", {\n    onClick: onLogout\n  }, \"salir\"))))));\n};\n\nconst Wallet = () => {\n  const wallet = useSelector(state => state.nav.notifications.wallet);\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"p\", {\n    className: \"wallet_cont\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faCoins\n  })), __jsx(\"span\", {\n    style: {\n      fontSize: 16\n    }\n  }, \"+\", wallet));\n};\n\nconst Notifications = () => {\n  return __jsx(\"ul\", {\n    className: \"notifications_main_cont\"\n  }, __jsx(\"li\", null, __jsx(Gift, null)), __jsx(\"li\", null, __jsx(Note, null)), __jsx(\"li\", null, __jsx(Friend, null)), __jsx(\"li\", null, __jsx(Option, null)), __jsx(\"li\", null, __jsx(Wallet, null)));\n};\n\nconst BarLoader = () => {\n  const loader = useSelector(state => state.nav.loader);\n  const dispatch = useDispatch();\n  const onLoader = useCallback(loader => dispatch({\n    type: ON_LOADER,\n    loader\n  }));\n  return __jsx(\"div\", {\n    className: \"barloader\",\n    style: {\n      width: `${loader}%`,\n      opacity: loader > 0 ? 1 : 0\n    }\n  });\n};\n\nconst Header = () => {\n  const nav = useSelector(state => state.nav);\n  const {\n    0: width,\n    1: setWidth\n  } = useState(0);\n  const dispatch = useDispatch();\n\n  const onNotifications = async () => {\n    try {\n      if (nav.login) {\n        const res = await axios.get(`/user/notifications`);\n        dispatch({\n          type: ON_NOTIFICATIONS,\n          notifications: res.data\n        });\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    const socket = io();\n    socket.open();\n    socket.on(`nav:${nav.notifications.id}`, payload => {\n      dispatch({\n        type: 'ON_NOTE',\n        payload\n      });\n      dispatch({\n        type: ON_FLOAT,\n        payload\n      });\n    });\n    return () => socket.close();\n  }, [nav.notifications]);\n  useEffect(() => {\n    onNotifications();\n  }, [nav.login]);\n  useEffect(() => {\n    setWidth(window.innerWidth);\n  }, []);\n  return __jsx(\"header\", {\n    className: \"header_main_cont\"\n  }, __jsx(BarLoader, null), __jsx(\"nav\", null, __jsx(DownBar, null), __jsx(\"div\", {\n    className: \"logo_search\"\n  }, __jsx(Logo, {\n    url: \"/\"\n  }), nav.login && width > 992 && __jsx(SearchBar, null)), !nav.login && __jsx(Link, {\n    href: \"/login\"\n  }, __jsx(\"button\", {\n    className: \"btn_login\"\n  }, \"login\")), nav.login && __jsx(Notifications, null)), width < 576 && nav.login && __jsx(SearchBar, null));\n};\n\nexport default Header;","map":null,"metadata":{},"sourceType":"module"}