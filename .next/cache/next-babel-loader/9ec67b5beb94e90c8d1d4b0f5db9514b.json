{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nvar __jsx = React.createElement;\nimport React, { useState, useReducer } from 'react';\nimport './creator.scss';\nimport { Modal } from 'reactstrap';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { ON_GREEN_CREATOR } from '../../store/actions';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCamera, faArrowCircleLeft } from '@fortawesome/free-solid-svg-icons';\nimport Store from '../store/store';\nimport axios from 'axios';\n\nvar GreenPost = function GreenPost(_ref) {\n  var img = _ref.img,\n      setImg = _ref.setImg,\n      onImg = _ref.onImg,\n      historyVisible = _ref.historyVisible,\n      setHistoryVisible = _ref.setHistoryVisible,\n      onSubmit = _ref.onSubmit,\n      history = _ref.history,\n      setHistory = _ref.setHistory;\n  return __jsx(\"div\", {\n    style: {\n      backgroundImage: \"url(\".concat(img, \")\")\n    },\n    className: \"creator_greenpost_main\"\n  }, __jsx(\"label\", {\n    htmlFor: \"green\"\n  }, __jsx(\"input\", {\n    id: \"green\",\n    name: \"green\",\n    onChange: onImg,\n    type: \"file\"\n  }), __jsx(FontAwesomeIcon, {\n    icon: faCamera\n  })), __jsx(\"div\", {\n    className: \"history_main_cont\",\n    style: {\n      transform: historyVisible ? 'translateX(0)' : 'translateX(100%)'\n    }\n  }, __jsx(\"div\", {\n    className: \"body\"\n  }, __jsx(\"header\", null, __jsx(\"h2\", null, \"Agrega una historia\")), __jsx(\"textarea\", {\n    onChange: function onChange(e) {\n      return setHistory(e.currentTarget.value);\n    },\n    value: history\n  })), __jsx(\"footer\", null, __jsx(\"button\", {\n    onClick: onSubmit\n  }, \"crear\"))), __jsx(\"button\", {\n    onClick: function onClick() {\n      return setHistoryVisible(!historyVisible);\n    },\n    title: \"Agregar historia\",\n    style: {\n      transform: historyVisible ? 'rotate(180deg)' : null\n    },\n    className: \"arrow_history\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faArrowCircleLeft\n  })));\n};\n\nvar Creator = function Creator() {\n  var visible = useSelector(function (state) {\n    return state.greenpost.creator;\n  });\n  var dispatch = useDispatch();\n\n  var _useReducer = useReducer(function (state, next) {\n    return _objectSpread({}, state, next);\n  }, {\n    green: true,\n    store: false\n  }),\n      section = _useReducer[0],\n      setSection = _useReducer[1];\n\n  var _useState = useState(true),\n      historyVisible = _useState[0],\n      setHistoryVisible = _useState[1];\n\n  var _useState2 = useState(false),\n      store = _useState2[0],\n      setStore = _useState2[1];\n\n  var _useState3 = useState('/static/random/r16.jpg'),\n      img = _useState3[0],\n      setImg = _useState3[1];\n\n  var _useState4 = useState(''),\n      history = _useState4[0],\n      setHistory = _useState4[1];\n\n  var onImg = function onImg(e) {\n    var img = e.target.files[0];\n    var reader = new FileReader();\n\n    reader.onloadend = function () {\n      if (reader.result) {\n        setImg(reader.result);\n        setHistoryVisible(true);\n      } else {\n        setImg('/static/random/r16.jpg');\n      }\n    };\n\n    reader.readAsDataURL(img);\n  };\n\n  var onSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              data = {\n                history: history,\n                img: img\n              };\n              _context.next = 4;\n              return axios.post('/post/greenpost', data);\n\n            case 4:\n              _context.next = 9;\n              break;\n\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 6]]);\n    }));\n\n    return function onSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Modal, {\n    isOpen: visible,\n    style: {\n      maxWidth: '90vw'\n    }\n  }, __jsx(\"div\", {\n    className: \"creator_main_cont\"\n  }, __jsx(\"header\", null, __jsx(\"p\", null, \"GreenPost\"), __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: ON_GREEN_CREATOR\n      });\n    }\n  }, \"X\")), __jsx(\"div\", {\n    className: \"body\"\n  }, section.green && __jsx(GreenPost, {\n    onImg: onImg,\n    img: img,\n    setImg: setImg,\n    historyVisible: historyVisible,\n    setHistoryVisible: setHistoryVisible,\n    history: history,\n    setHistory: setHistory\n  }), section.store && __jsx(Store, null))));\n};\n\nexport default Creator;","map":{"version":3,"sources":["/home/felix/Documentos/projects/greenlink/components/greenpost/creator.jsx"],"names":["React","useState","useReducer","Modal","useSelector","useDispatch","ON_GREEN_CREATOR","FontAwesomeIcon","faCamera","faArrowCircleLeft","Store","axios","GreenPost","img","setImg","onImg","historyVisible","setHistoryVisible","onSubmit","history","setHistory","backgroundImage","transform","e","currentTarget","value","Creator","visible","state","greenpost","creator","dispatch","next","green","store","section","setSection","setStore","target","files","reader","FileReader","onloadend","result","readAsDataURL","data","post","console","log","maxWidth","type"],"mappings":"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","sourcesContent":["import React, { useState, useReducer } from 'react';\nimport './creator.scss';\nimport { Modal } from 'reactstrap';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { ON_GREEN_CREATOR } from '../../store/actions';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCamera, faArrowCircleLeft } from '@fortawesome/free-solid-svg-icons';\nimport Store from '../store/store';\nimport axios from 'axios';\n\nconst GreenPost = ({ img, setImg, onImg, historyVisible, setHistoryVisible, onSubmit, history, setHistory }) => {\n  return(\n    <div style={{ backgroundImage: `url(${img})`}} className=\"creator_greenpost_main\">\n      <label htmlFor=\"green\">\n        <input id=\"green\" name=\"green\" onChange={onImg} type=\"file\"/>\n        <FontAwesomeIcon icon={faCamera} />\n      </label>\n      <div className=\"history_main_cont\" style={{ transform: historyVisible ? 'translateX(0)' : 'translateX(100%)' }}>\n        <div className=\"body\">\n          <header><h2>Agrega una historia</h2></header>\n          <textarea onChange={(e)=> setHistory(e.currentTarget.value)} value={history} />\n        </div>\n        <footer>\n          <button onClick={onSubmit}>crear</button>\n        </footer>\n      </div>\n      <button onClick={()=> setHistoryVisible(!historyVisible)} title=\"Agregar historia\" style={{ transform: historyVisible ? 'rotate(180deg)' : null }} className=\"arrow_history\">\n        <FontAwesomeIcon icon={faArrowCircleLeft} />\n      </button>\n    </div>\n  )\n}\n\nconst Creator = () => {\n  const visible = useSelector(state => state.greenpost.creator);\n  const dispatch = useDispatch();\n  const [section, setSection] = useReducer((state, next) => ({ ...state, ...next }),{ green: true, store: false });\n  const [historyVisible, setHistoryVisible] = useState(true);\n  const [store, setStore] = useState(false);\n  const [img, setImg]   = useState('/static/random/r16.jpg');\n  const [history, setHistory] = useState('');\n\n  const onImg = (e) => {\n    const img = e.target.files[0];\n    const reader = new FileReader();\n    reader.onloadend = ()=> {\n      if(reader.result){\n        setImg(reader.result);\n        setHistoryVisible(true);\n      } else {\n        setImg('/static/random/r16.jpg');\n      }\n    };\n    reader.readAsDataURL(img);\n  };\n\n  const onSubmit = async() => {\n    try{\n      const data = {\n        history,\n        img,\n      }\n      await axios.post('/post/greenpost', data);\n    }catch(err){\n      console.log(err);\n    }\n  }\n\n  return(\n    <Modal isOpen={visible} style={{ maxWidth: '90vw' }}>\n      <div className=\"creator_main_cont\">\n        <header>\n          <p>GreenPost</p>\n          <button onClick={()=> dispatch({ type: ON_GREEN_CREATOR })}>X</button>\n        </header>\n        <div className=\"body\">\n          { section.green && (\n            <GreenPost\n              onImg={onImg}\n              img={img}\n              setImg={setImg}\n              historyVisible={historyVisible}\n              setHistoryVisible={setHistoryVisible}\n              history={history}\n              setHistory={setHistory}\n              />\n            )\n          }\n          { section.store && <Store /> }\n        </div>\n      </div>\n    </Modal>\n  )\n}\n\nexport default Creator;\n"]},"metadata":{},"sourceType":"module"}