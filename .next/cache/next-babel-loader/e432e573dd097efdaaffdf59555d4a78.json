{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { storeSections, ON_PRODUCTS, ON_WALLET, ON_STORE, ON_WISH } from '../../store/actions';\nimport './store.scss';\nimport products from '../../test/products';\nimport axios from 'axios';\nimport uuid from 'uuid/v1';\n\nvar Home = function Home() {\n  var dispatch = useDispatch();\n  return __jsx(\"div\", {\n    className: \"storehome_main_cont\"\n  }, __jsx(\"div\", {\n    className: \"cont_left\"\n  }, __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: storeSections.MUSIC\n      });\n    },\n    id: \"music\"\n  }, __jsx(\"img\", {\n    src: \"/static/store/ms.jpg\",\n    alt: \"\"\n  }), __jsx(\"span\", null, \"musica\"))), __jsx(\"div\", {\n    className: \"cont_right\"\n  }, __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: storeSections.CANDY\n      });\n    },\n    id: \"candy\"\n  }, __jsx(\"img\", {\n    src: \"/static/store/gol.jpg\",\n    alt: \"\"\n  }), __jsx(\"span\", null, \"golosinas\")), __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: storeSections.JEWEL\n      });\n    },\n    className: \"four\",\n    id: \"jewel\"\n  }, __jsx(\"img\", {\n    src: \"/static/store/bis.jpg\",\n    alt: \"\"\n  }), __jsx(\"span\", null, \"bisuteria\")), __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: storeSections.TOY\n      });\n    },\n    className: \"four\",\n    id: \"toy\"\n  }, __jsx(\"img\", {\n    src: \"/static/store/ty.jpg\",\n    alt: \"\"\n  }), __jsx(\"span\", null, \"juguetes\")), __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: storeSections.EBOOK\n      });\n    },\n    className: \"four\",\n    id: \"ebook\"\n  }, __jsx(\"img\", {\n    src: \"/static/store/eb.jpg\",\n    alt: \"\"\n  }), __jsx(\"span\", null, \"ebook's\")), __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: storeSections.TV\n      });\n    },\n    className: \"four\",\n    id: \"tv\"\n  }, __jsx(\"img\", {\n    src: \"static/store/tv.jpg\",\n    alt: \"\"\n  }), __jsx(\"span\", null, \"tv's\"))));\n};\n\nvar Category = function Category(_ref) {\n  var tag = _ref.tag;\n  var items = useSelector(function (state) {\n    return state.greenstore.items;\n  });\n  var products = items.filter(function (product) {\n    return product.tag === tag;\n  });\n  var dispatch = useDispatch();\n\n  var onProduct = function onProduct(e) {\n    var product = products.find(function (product) {\n      return product.id === e.target.id;\n    });\n    dispatch({\n      type: storeSections.PRODUCT,\n      product: product\n    });\n  };\n\n  return __jsx(\"div\", {\n    className: \"category_main_cont\"\n  }, __jsx(\"ul\", null, products.map(function (product) {\n    return __jsx(\"li\", null, __jsx(\"button\", {\n      onClick: onProduct,\n      id: product.id,\n      className: \"shadow\"\n    }, __jsx(\"img\", {\n      id: product.id,\n      src: product.img,\n      alt: \"\"\n    }), __jsx(\"footer\", {\n      id: product.id\n    }, __jsx(\"p\", {\n      id: product.id\n    }, product.name), __jsx(\"p\", {\n      id: product.id\n    }, \"$\", product.price))));\n  })));\n};\n\nvar Product = function Product() {\n  var product = useSelector(function (state) {\n    return state.greenstore.current;\n  });\n  var uid = useSelector(function (state) {\n    return state.user._id;\n  });\n  var dispatch = useDispatch();\n  var owner = useSelector(function (state) {\n    return state.user.owner;\n  });\n\n  var _useState = useState(false),\n      disable = _useState[0],\n      setDisable = _useState[1];\n\n  var _useState2 = useState(),\n      note = _useState2[0],\n      setNote = _useState2[1];\n\n  var onGift =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var data, parseCoin;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              e.preventDefault();\n              setDisable(true);\n              data = {\n                gift: product,\n                uid: uid,\n                note: note\n              };\n              _context.next = 6;\n              return axios.post('/user/gift', data);\n\n            case 6:\n              parseCoin = _parseInt(product.price, 10);\n              dispatch({\n                type: ON_WALLET,\n                coin: -parseCoin\n              });\n              setDisable(false);\n              dispatch({\n                type: ON_STORE\n              });\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 12]]);\n    }));\n\n    return function onGift(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onWish =\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(e) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              e.preventDefault();\n              setDisable(true);\n              _context2.next = 5;\n              return axios.post('/green/wish', {\n                product: product\n              });\n\n            case 5:\n              res = _context2.sent;\n              console.log(res.data);\n              dispatch({\n                type: ON_WISH,\n                wish: res.data\n              });\n              setDisable(false);\n              dispatch({\n                type: ON_STORE\n              });\n              _context2.next = 15;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 12]]);\n    }));\n\n    return function onWish(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"product_main_cont\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-12 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"img_cont\"\n  }, __jsx(\"img\", {\n    src: product.img,\n    alt: \"\"\n  }))), __jsx(\"div\", {\n    className: \"col-12 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"description_cont\"\n  }, __jsx(\"h1\", null, product.name), __jsx(\"p\", null, \"precio: $\", product.price), __jsx(\"p\", null, product.description)), __jsx(\"form\", {\n    onSubmit: owner ? onWish : onGift\n  }, !owner && __jsx(\"textarea\", {\n    value: note,\n    onChange: function onChange(e) {\n      return setNote(e.currentTarget.value);\n    }\n  }), __jsx(\"footer\", null, __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatch({\n        type: product.tag\n      });\n    }\n  }, \"atr\\xE1s\"), __jsx(\"button\", {\n    disabled: disable,\n    type: \"submit\"\n  }, owner ? 'agregar' : 'enviar'))))));\n};\n\nvar Store = function Store() {\n  var store = useSelector(function (state) {\n    return state.greenstore;\n  });\n  var dispatch = useDispatch();\n\n  var onProducts =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              try {\n                //const res = await axios.get('/products');\n                //dispatch({ type: ON_PRODUCTS, products: res.data });\n                dispatch({\n                  type: ON_PRODUCTS,\n                  products: products\n                });\n              } catch (err) {\n                console.log(err);\n              }\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function onProducts() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    onProducts();\n  }, []);\n  return __jsx(\"div\", {\n    className: \"store_main_cont\"\n  }, store.home && __jsx(Home, null), store.music && __jsx(Category, {\n    tag: storeSections.MUSIC\n  }), store.candy && __jsx(Category, {\n    tag: storeSections.CANDY\n  }), store.jewel && __jsx(Category, {\n    tag: storeSections.JEWEL\n  }), store.toy && __jsx(Category, {\n    tag: storeSections.TOY\n  }), store.ebook && __jsx(Category, {\n    tag: storeSections.EBOOK\n  }), store.tv && __jsx(Category, {\n    tag: storeSections.TV\n  }), store.product && __jsx(Product, null));\n};\n\nexport default Store;","map":null,"metadata":{},"sourceType":"module"}