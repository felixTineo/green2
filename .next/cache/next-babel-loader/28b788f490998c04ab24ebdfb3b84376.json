{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { ON_CHAT_FRIEND, ON_CHAT_PRIVATE, ON_CHAT_MINIMIZE, ON_CHAT_ALERT } from '../../store/actions';\nimport { color } from '../../layout/var';\nimport uuid from 'uuid/v1';\nimport persons from '../../test/persons';\nimport io from 'socket.io-client';\nimport axios from 'axios'; //const friends = persons(8);\n\nvar Friend = function Friend(_ref) {\n  var perfilImg = _ref.perfilImg,\n      fullName = _ref.fullName,\n      _id = _ref._id,\n      url = _ref.url,\n      chatHistory = _ref.chatHistory;\n  var dispatch = useDispatch();\n  var privates = useSelector(function (state) {\n    return state.chat.privates;\n  });\n  var cuid = useSelector(function (state) {\n    return state.nav.notifications.id;\n  });\n  useEffect(function () {\n    console.log('friend');\n    var user = {\n      perfilImg: perfilImg,\n      fullName: fullName,\n      _id: _id,\n      url: url,\n      chatHistory: chatHistory,\n      minimize: false,\n      anAlert: false\n    };\n    var socket = io();\n    socket.open();\n    socket.on(\"notification:\".concat(cuid), function (_id) {\n      var isOpen = privates.find(function (user) {\n        return user._id === _id;\n      });\n\n      if (isOpen && isOpen.minimize) {\n        dispatch({\n          type: ON_CHAT_ALERT,\n          _id: _id,\n          option: true\n        });\n      } else if (!isOpen) {\n        dispatch({\n          type: ON_CHAT_PRIVATE,\n          user: user\n        });\n      }\n    });\n    return function () {\n      return socket.close();\n    };\n  }, [privates]);\n\n  var onPrivate = function onPrivate() {\n    try {\n      var user = {\n        perfilImg: perfilImg,\n        fullName: fullName,\n        _id: _id,\n        url: url,\n        chatHistory: chatHistory,\n        minimize: false,\n        anAlert: false\n      };\n      var isOpen = privates.find(function (user) {\n        return user._id === _id;\n      });\n\n      if (isOpen) {\n        dispatch({\n          type: ON_CHAT_MINIMIZE,\n          _id: _id,\n          option: false\n        });\n      } else {\n        dispatch({\n          type: ON_CHAT_PRIVATE,\n          user: user\n        });\n      }\n\n      setTimeout(function () {\n        return document.getElementById(_id).focus();\n      }, 200);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return __jsx(\"button\", {\n    onClick: onPrivate,\n    type: \"button\",\n    className: _JSXStyle.dynamic([[\"1182382733\", [color.prim, color.light, color.sec, color.dark, color.dark]]])\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1182382733\", [color.prim, color.light, color.sec, color.dark, color.dark]]])\n  }, __jsx(\"img\", {\n    src: perfilImg,\n    alt: \"\",\n    className: _JSXStyle.dynamic([[\"1182382733\", [color.prim, color.light, color.sec, color.dark, color.dark]]])\n  })), __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"1182382733\", [color.prim, color.light, color.sec, color.dark, color.dark]]])\n  }, fullName), __jsx(_JSXStyle, {\n    id: \"1182382733\",\n    dynamic: [color.prim, color.light, color.sec, color.dark, color.dark]\n  }, [\"button.__jsx-style-dynamic-selector{background:transparent;border:none;-webkit-transition:250ms ease;transition:250ms ease;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0;border:1px solid rgba(139,185,64,.4);width:100%;text-transform:capitalize;}\", \"button.__jsx-style-dynamic-selector:outline{outline:none;}\", \"button.__jsx-style-dynamic-selector:hover{background:\".concat(color.prim, \";color:\").concat(color.light, \";border-color:\").concat(color.sec, \";}\"), \"p.__jsx-style-dynamic-selector{margin:0;color:\".concat(color.dark, \";margin-left:.5rem;}\"), \"div.__jsx-style-dynamic-selector{background:\".concat(color.dark, \";width:55px;height:45px;border-left:8px solid rgba(255,255,255,.4);}\"), \"img.__jsx-style-dynamic-selector{width:40px;height:40px;object-fit:cover;object-position:center;border-radius:50%;}\"]));\n};\n\nvar Friends = function Friends() {\n  var _useState = useState([]),\n      friends = _useState[0],\n      setFriends = _useState[1];\n\n  var id = useSelector(function (state) {\n    return state.nav.notifications.id;\n  });\n\n  var all =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.get('/chat/all');\n\n            case 3:\n              res = _context.sent;\n              setFriends(res.data);\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function all() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    var socket = io();\n    socket.open();\n    socket.on(\"chat:\".concat(id), function (payload) {\n      return all();\n    });\n    all();\n    return function () {\n      return socket.close();\n    };\n  }, [id]);\n  return __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2226638880\", [color.prim, color.sec]]]) + \" \" + \"main\"\n  }, __jsx(\"header\", {\n    className: _JSXStyle.dynamic([[\"2226638880\", [color.prim, color.sec]]])\n  }, \"chat\"), __jsx(\"ul\", {\n    className: _JSXStyle.dynamic([[\"2226638880\", [color.prim, color.sec]]])\n  }, friends.map(function (friend) {\n    return __jsx(\"li\", {\n      key: uuid(),\n      className: _JSXStyle.dynamic([[\"2226638880\", [color.prim, color.sec]]])\n    }, __jsx(Friend, friend));\n  })), __jsx(_JSXStyle, {\n    id: \"2226638880\",\n    dynamic: [color.prim, color.sec]\n  }, [\".main.__jsx-style-dynamic-selector{height:calc(100vh - 40px);background:rgba(0,0,0,0.070);position:-webkit-sticky;position:sticky;top:42px;}\", \"header.__jsx-style-dynamic-selector{color:rgba(255,255,255,0.7);font-weight:550;background:\".concat(color.prim, \";padding:.5rem;text-align:center;text-transform:uppercase;}\"), \"ul.__jsx-style-dynamic-selector{list-style:none;padding:0;margin:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:calc(100% - 40px);overflow:hidden;overflow-y:scroll;border-left:2px solid \".concat(color.sec, \";}\")]));\n};\n\nexport default Friends;","map":null,"metadata":{},"sourceType":"module"}