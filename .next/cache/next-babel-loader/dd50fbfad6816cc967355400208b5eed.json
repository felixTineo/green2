{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { ON_GREEN_COMMENT } from '../../store/actions';\nimport uuid from 'uuid/v1';\nimport { color } from '../../layout/var';\nimport axios from 'axios';\nimport io from 'socket.io-client';\n\nconst CommentList = ({\n  comment,\n  perfilImg,\n  fullName\n}) => {\n  const owner = useSelector(state => state.user.owner);\n  return __jsx(\"li\", {\n    className: _JSXStyle.dynamic([[\"814670264\", [owner ? color.prim : \"#bbb\", color.dark, color.light]]]) + \" \" + \"shadow\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"814670264\", [owner ? color.prim : \"#bbb\", color.dark, color.light]]])\n  }, __jsx(\"img\", {\n    src: perfilImg,\n    alt: \"\",\n    className: _JSXStyle.dynamic([[\"814670264\", [owner ? color.prim : \"#bbb\", color.dark, color.light]]])\n  }), __jsx(\"small\", {\n    className: _JSXStyle.dynamic([[\"814670264\", [owner ? color.prim : \"#bbb\", color.dark, color.light]]])\n  }, fullName)), __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"814670264\", [owner ? color.prim : \"#bbb\", color.dark, color.light]]])\n  }, comment), __jsx(_JSXStyle, {\n    id: \"814670264\",\n    dynamic: [owner ? color.prim : \"#bbb\", color.dark, color.light]\n  }, [`li.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-top:.5rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:#fff;min-width:20%;border-left:5px solid ${owner ? color.prim : \"#bbb\"};}`, \"p.__jsx-style-dynamic-selector{margin:0;padding:.3rem;}\", `div.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:${color.dark};padding:.2rem;}`, `small.__jsx-style-dynamic-selector{margin-left:.2rem;color:${color.light};}`, \"img.__jsx-style-dynamic-selector{width:25px;height:25px;border-radius:50%;object-fit:cover;object-position:center;}\"]));\n};\n\nconst Comment = () => {\n  const dispatch = useDispatch();\n  const comments = useSelector(state => state.greenpost.current.comments);\n  const {\n    0: value,\n    1: setValue\n  } = useState('');\n  const {\n    0: disable,\n    1: setDisable\n  } = useState(false);\n  const input = useRef(null);\n  const scroll = useRef(null);\n  const pid = useSelector(state => state.greenpost.current._id);\n  useEffect(() => {\n    const socket = io();\n    socket.open();\n    socket.on(`green:${pid}`, newComment => {\n      console.log(newComment);\n      dispatch({\n        type: ON_GREEN_COMMENT,\n        comment: newComment\n      });\n      scroll.current.scrollTo(0, scroll.current.scrollHeight);\n    });\n    return () => socket.close();\n  }, [comments]);\n  useEffect(() => {\n    scroll.current.scrollTo(0, scroll.current.scrollHeight);\n    input.current.focus();\n  }, [comments]);\n\n  const onSubmit = async e => {\n    try {\n      if (e.keyCode === 13 && e.shiftKey === false) {\n        e.preventDefault();\n        setDisable(true);\n        const data = {\n          comment: value,\n          pid\n        };\n        const res = await axios.post('/green/comment/add', data);\n        setDisable(false);\n        setValue('');\n        input.current.focus();\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2967572591\", [color.prim, color.sec, color.light, color.light, color.sec]]]) + \" \" + \"main_cont animated fadeIn\"\n  }, __jsx(\"ul\", {\n    ref: scroll,\n    className: _JSXStyle.dynamic([[\"2967572591\", [color.prim, color.sec, color.light, color.light, color.sec]]])\n  }, comments.map(comment => __jsx(CommentList, _extends({}, comment, {\n    key: uuid()\n  })))), __jsx(\"form\", {\n    onSubmit: onSubmit,\n    className: _JSXStyle.dynamic([[\"2967572591\", [color.prim, color.sec, color.light, color.light, color.sec]]])\n  }, __jsx(\"textarea\", {\n    disabled: disable,\n    onKeyDown: onSubmit,\n    ref: input,\n    value: value,\n    onChange: e => setValue(e.currentTarget.value),\n    name: \"\",\n    id: \"\",\n    className: _JSXStyle.dynamic([[\"2967572591\", [color.prim, color.sec, color.light, color.light, color.sec]]])\n  })), __jsx(_JSXStyle, {\n    id: \"2967572591\",\n    dynamic: [color.prim, color.sec, color.light, color.light, color.sec]\n  }, [\".main_cont.__jsx-style-dynamic-selector{height:100%;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \"ul.__jsx-style-dynamic-selector{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;list-style:none;margin:0;padding:0;width:100%;height:100%;overflow-y:scroll;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:45px 20px 0px;}\", \"ul.__jsx-style-dynamic-selector::-webkit-scrollbar{width:0;}\", `form.__jsx-style-dynamic-selector{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background:${color.prim};padding:.5rem;}`, `textarea.__jsx-style-dynamic-selector{resize:none;border-radius:2px;border:1px solid ${color.sec};}`, `button.__jsx-style-dynamic-selector{margin-top:.5rem;-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;background:transparent;border:2px solid ${color.light};color:${color.light};-webkit-transition:250ms ease;transition:250ms ease;}`, \"button.__jsx-style-dynamic-selector:focus{outline:none;}\", `button.__jsx-style-dynamic-selector:hover{background:${color.sec};}`]));\n};\n\nexport default Comment;","map":null,"metadata":{},"sourceType":"module"}