{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect, useCallback, useState } from 'react';\nimport Logo from './logo';\nimport Router from 'next/router';\nimport './header.scss';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch, faGift, faHeart, faUser, faCog, faCoins, faBell } from '@fortawesome/free-solid-svg-icons';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { navView, ON_VIEW_NAV, ON_LOADER, ON_NOTIFICATIONS, ON_LOGIN } from '../../store/actions';\nimport axios from 'axios';\nimport Link from 'next/link';\nimport { Popover, PopoverBody } from 'reactstrap';\nimport uuid from 'uuid/v1';\nimport io from 'socket.io-client';\nimport MyLink from '../mylink/link';\n\nconst DownBar = () => {\n  const {\n    0: down,\n    1: setDown\n  } = useState(false);\n  useEffect(() => {\n    window.onscroll = () => {\n      if (window.scrollY > 30) {\n        setDown(true);\n      } else {\n        setDown(false);\n      }\n    };\n  }, []);\n  const {\n    0: sm,\n    1: setSm\n  } = useState(false);\n  useEffect(() => {\n    if (window.innerWidth < 576) {\n      setSm(true);\n    }\n  }, []);\n  return __jsx(\"div\", {\n    className: \"down_bar\",\n    style: {\n      height: down || sm ? 40 : 0\n    }\n  });\n};\n\nconst SearchBar = () => {\n  const testList = [\"felix\", \"luis\", \"maximiliano\", \"francisco\", 'teresa', 'yleana'];\n  const {\n    0: suggest,\n    1: setSuggest\n  } = useState([]);\n\n  const onSuggest = async e => {\n    const value = e.target.value;\n\n    if (value) {\n      value.toLocaleLowerCase();\n      const res = await axios.get(`/user/search/${value}`);\n      setSuggest(res.data);\n    } else {\n      setSuggest([]);\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"searchbar_main_cont\"\n  }, __jsx(\"div\", {\n    className: \"search_cont\"\n  }, __jsx(\"input\", {\n    onChange: onSuggest,\n    type: \"text\"\n  }), __jsx(\"p\", null, __jsx(FontAwesomeIcon, {\n    icon: faSearch\n  }))), __jsx(\"ul\", {\n    style: {\n      padding: suggest.length > 0 ? '.2rem' : '0'\n    },\n    className: \"sugesstlist\"\n  }, suggest.map(item => __jsx(\"li\", {\n    key: uuid()\n  }, __jsx(MyLink, {\n    id: item._id\n  }, __jsx(\"div\", {\n    className: \"user_search_cont\"\n  }, __jsx(\"img\", {\n    src: item.perfilImg,\n    alt: \"\"\n  }), __jsx(\"p\", null, item.fullName)))))));\n};\n\nconst Gift = () => {\n  const gifts = useSelector(state => state.nav.notifications.gifts);\n  const dispatch = useDispatch();\n  const onView = useCallback(() => {\n    dispatch({\n      type: ON_VIEW_NAV,\n      note: navView.GIFT\n    });\n  });\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"gift\",\n    onClick: onView,\n    style: gifts.view && gifts.length > 0 ? {\n      background: \"#fff\",\n      color: \"#ff6c1a\"\n    } : {\n      background: \"transparent\",\n      color: \"#fff\"\n    },\n    className: \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faGift\n  })), __jsx(\"span\", {\n    style: gifts.view && gifts.length > 0 ? {\n      color: \"#ff6c1a\"\n    } : {\n      color: \"#fff\"\n    }\n  }, \"+\", gifts.items.length));\n};\n\nconst Note = () => {\n  const notes = useSelector(state => state.nav.notifications.notes);\n  const dispatch = useDispatch();\n  const onView = useCallback(() => {\n    dispatch({\n      type: ON_VIEW_NAV,\n      note: navView.NOTES\n    });\n  });\n  const {\n    0: pop,\n    1: setPop\n  } = useState(false);\n\n  const handleView = () => {\n    onView();\n    setPop(!pop);\n  };\n\n  const handleViewOut = () => {\n    setPop(false);\n  };\n\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"note\",\n    onClick: handleView,\n    style: notes.view && notes.length > 0 ? {\n      background: \"#fff\",\n      color: \"#ff6c1a\"\n    } : {\n      background: \"transparent\",\n      color: \"#fff\"\n    },\n    className: \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faBell\n  })), __jsx(\"span\", {\n    style: notes.view && notes.length > 0 ? {\n      color: \"#ff6c1a\"\n    } : {\n      color: \"#fff\"\n    }\n  }, \"+\", notes.items.length), __jsx(Popover, {\n    target: \"note\",\n    isOpen: pop,\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"ul\", {\n    onClick: handleViewOut\n  }, notes.items.map(item => __jsx(\"li\", {\n    key: uuid()\n  }, item.id))))));\n};\n\nconst Friend = () => {\n  const friend = useSelector(state => state.nav.notifications.friendReq);\n  const dispatch = useDispatch();\n  const onView = useCallback(() => {\n    dispatch({\n      type: ON_VIEW_NAV,\n      note: navView.FRIEND\n    });\n  });\n  /*  const [list, setList] = useState([]);\n    useEffect(()=> {\n      setList(friend.items);\n    },[friend.items]);*/\n\n  const {\n    0: pop,\n    1: setPop\n  } = useState(false);\n\n  const handleView = () => {\n    onView();\n    setPop(!pop);\n  };\n\n  const handleViewOut = () => {\n    setPop(false);\n  };\n\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"friend\",\n    onClick: handleView,\n    style: friend.view && friend.length > 0 ? {\n      background: \"#fff\",\n      color: \"#ff6c1a\"\n    } : {\n      background: \"transparent\",\n      color: \"#fff\"\n    },\n    className: \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faUser\n  })), __jsx(\"span\", {\n    style: friend.view && friend.length > 0 ? {\n      color: \"#ff6c1a\"\n    } : {\n      color: \"#fff\"\n    }\n  }, \"+\", friend.items.length), __jsx(Popover, {\n    target: \"friend\",\n    isOpen: pop,\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"ul\", {\n    onMouseLeave: handleViewOut\n  }, friend.items.map(item => __jsx(\"li\", {\n    key: uuid()\n  }, item.name))))));\n};\n\nconst Option = () => {\n  const {\n    0: pop,\n    1: setPop\n  } = useState(false);\n  const dispatch = useDispatch();\n  const onLogout = useCallback(async () => {\n    try {\n      await axios.get('/user/logout');\n      dispatch({\n        type: ON_LOGIN,\n        option: false\n      });\n      Router.push('/login');\n    } catch (err) {\n      console.log(err);\n    }\n  });\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"button\", {\n    id: \"option\",\n    onClick: () => setPop(!pop),\n    className: \"btnicon_nav\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faCog\n  })), __jsx(Popover, {\n    target: \"option\",\n    isOpen: pop,\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, {\n    style: {\n      padding: 0\n    }\n  }, __jsx(\"ul\", {\n    className: \"option_list\",\n    onMouseLeave: () => setPop(false)\n  }, __jsx(\"li\", null, __jsx(\"button\", null, \"perfil\")), __jsx(\"li\", null, __jsx(\"button\", {\n    onClick: onLogout\n  }, \"salir\"))))));\n};\n\nconst Wallet = () => {\n  const wallet = useSelector(state => state.nav.notifications.wallet);\n  return __jsx(\"div\", {\n    className: \"btnicon_cont\"\n  }, __jsx(\"p\", {\n    className: \"wallet_cont\"\n  }, __jsx(FontAwesomeIcon, {\n    icon: faCoins\n  })), __jsx(\"span\", {\n    style: {\n      fontSize: 16\n    }\n  }, \"+\", wallet));\n};\n\nconst Notifications = () => {\n  return __jsx(\"ul\", {\n    className: \"notifications_main_cont\"\n  }, __jsx(\"li\", null, __jsx(Gift, null)), __jsx(\"li\", null, __jsx(Note, null)), __jsx(\"li\", null, __jsx(Friend, null)), __jsx(\"li\", null, __jsx(Option, null)), __jsx(\"li\", null, __jsx(Wallet, null)));\n};\n\nconst BarLoader = () => {\n  const loader = useSelector(state => state.nav.loader);\n  const dispatch = useDispatch();\n  const onLoader = useCallback(loader => dispatch({\n    type: ON_LOADER,\n    loader\n  }));\n  return __jsx(\"div\", {\n    className: \"barloader\",\n    style: {\n      width: `${loader}%`,\n      opacity: loader > 0 ? 1 : 0\n    }\n  });\n};\n\nconst Header = () => {\n  const nav = useSelector(state => state.nav);\n  const {\n    0: width,\n    1: setWidth\n  } = useState(0);\n  const dispatch = useDispatch();\n\n  const onNotifications = async () => {\n    try {\n      if (nav.login) {\n        const res = await axios.get(`/user/notifications`);\n        dispatch({\n          type: ON_NOTIFICATIONS,\n          notifications: res.data\n        });\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    const socket = io();\n    socket.open();\n    socket.on(`nav:${nav.notifications.id}`, payload => {\n      let items = nav.notifications[payload.note].items;\n      console.log(items);\n      items = [payload.user, ...nav.notifications[payload.note].items];\n      console.log(items);\n      const reduxPayload = {\n        note: payload.action,\n        items\n      };\n      dispatch({\n        type: 'ON_NOTE',\n        payload: reduxPayload\n      });\n    });\n    return () => socket.close();\n  }, [nav.notifications]);\n  useEffect(() => {\n    onNotifications();\n  }, [nav.login]);\n  useEffect(() => {\n    setWidth(window.innerWidth);\n  }, []);\n  return __jsx(\"header\", {\n    className: \"header_main_cont\"\n  }, __jsx(BarLoader, null), __jsx(\"nav\", null, __jsx(DownBar, null), __jsx(\"div\", {\n    className: \"logo_search\"\n  }, __jsx(Logo, {\n    url: \"/\"\n  }), nav.login && width > 992 && __jsx(SearchBar, null)), !nav.login && __jsx(Link, {\n    href: \"/login\"\n  }, __jsx(\"button\", {\n    className: \"btn_login\"\n  }, \"login\")), nav.login && __jsx(Notifications, null)), width < 576 && nav.login && __jsx(SearchBar, null));\n};\n\nexport default Header;","map":{"version":3,"sources":["/home/felix/Documentos/projects/greenlink/components/layout/header.jsx"],"names":["React","useEffect","useCallback","useState","Logo","Router","FontAwesomeIcon","faSearch","faGift","faHeart","faUser","faCog","faCoins","faBell","useSelector","useDispatch","navView","ON_VIEW_NAV","ON_LOADER","ON_NOTIFICATIONS","ON_LOGIN","axios","Link","Popover","PopoverBody","uuid","io","MyLink","DownBar","down","setDown","window","onscroll","scrollY","sm","setSm","innerWidth","height","SearchBar","testList","suggest","setSuggest","onSuggest","e","value","target","toLocaleLowerCase","res","get","data","padding","length","map","item","_id","perfilImg","fullName","Gift","gifts","state","nav","notifications","dispatch","onView","type","note","GIFT","view","background","color","items","Note","notes","NOTES","pop","setPop","handleView","handleViewOut","id","Friend","friend","friendReq","FRIEND","name","Option","onLogout","option","push","err","console","log","Wallet","wallet","fontSize","Notifications","BarLoader","loader","onLoader","width","opacity","Header","setWidth","onNotifications","login","socket","open","on","payload","user","reduxPayload","action","close"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useState } from 'react';\nimport Logo from './logo';\nimport Router from 'next/router';\nimport './header.scss';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch, faGift, faHeart, faUser, faCog, faCoins, faBell } from '@fortawesome/free-solid-svg-icons';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { navView, ON_VIEW_NAV, ON_LOADER, ON_NOTIFICATIONS, ON_LOGIN } from '../../store/actions';\nimport axios from 'axios';\nimport Link from 'next/link';\nimport { Popover, PopoverBody } from 'reactstrap';\nimport uuid from 'uuid/v1';\nimport io from 'socket.io-client';\nimport MyLink from '../mylink/link';\n\nconst DownBar = () => {\n  const [down, setDown] = useState(false);\n\n  useEffect(()=> {\n    window.onscroll = () => {\n      if(window.scrollY > 30){\n        setDown(true);\n      } else {\n        setDown(false);\n      }\n    }\n  }, []);\n\n  const [sm, setSm] = useState(false);\n  useEffect(()=> {\n    if(window.innerWidth < 576){\n      setSm(true);\n    }\n  },[])\n\n  return <div className=\"down_bar\" style={{ height: down || sm ? 40 : 0 }} />\n};\n\nconst SearchBar = () => {\n  const testList = [\"felix\", \"luis\", \"maximiliano\", \"francisco\", 'teresa', 'yleana'];\n  const [suggest, setSuggest] = useState([]);\n\n  const onSuggest = async (e) => {\n    const value = e.target.value;\n    if(value){\n      value.toLocaleLowerCase();\n      const res = await axios.get(`/user/search/${value}`);\n      setSuggest(res.data);\n    } else{\n      setSuggest([]);\n    }\n  }\n\n  return(\n    <div className=\"searchbar_main_cont\">\n      <div className=\"search_cont\">\n        <input onChange={onSuggest} type=\"text\"/>\n        <p><FontAwesomeIcon icon={faSearch} /></p>\n      </div>\n      <ul style={{ padding: suggest.length > 0 ? '.2rem' : '0' }} className=\"sugesstlist\">\n        {\n          suggest.map(item => (\n            <li key={uuid()}>\n              <MyLink id={item._id}>\n                <div className=\"user_search_cont\">\n                  <img src={item.perfilImg} alt=\"\"/>\n                  <p>{item.fullName}</p>\n                </div>\n              </MyLink>\n            </li>\n          ))\n        }\n      </ul>\n    </div>\n  )\n};\n\nconst Gift = () => {\n  const gifts = useSelector(state => state.nav.notifications.gifts);\n  const dispatch = useDispatch();\n  const onView = useCallback(()=> {\n    dispatch({ type: ON_VIEW_NAV, note: navView.GIFT });\n  })\n\n  return(\n    <div className=\"btnicon_cont\">\n      <button\n        id=\"gift\"\n        onClick={onView}\n        style={\n          gifts.view && gifts.length > 0\n            ? { background: \"#fff\", color: \"#ff6c1a\" }\n            : { background: \"transparent\", color: \"#fff\" }\n        }\n        className=\"btnicon_nav\"\n      >\n        <FontAwesomeIcon icon={faGift} />\n      </button>\n      <span\n        style={\n          gifts.view && gifts.length > 0\n          ? { color: \"#ff6c1a\" }\n          : { color: \"#fff\" }\n        }\n      >\n        +{gifts.items.length}\n      </span>\n    </div>\n  );\n}\n\nconst Note = () => {\n  const notes = useSelector(state => state.nav.notifications.notes);\n  const dispatch = useDispatch();\n  const onView = useCallback(()=> {\n    dispatch({ type: ON_VIEW_NAV, note: navView.NOTES });\n  });\n  const [pop, setPop] = useState(false);\n  const handleView = () => {\n    onView();\n    setPop(!pop);\n  };\n  const handleViewOut = () =>{\n    setPop(false)\n  }\n\n  return(\n    <div className=\"btnicon_cont\">\n      <button\n        id=\"note\"\n        onClick={handleView}\n        style={\n          notes.view && notes.length > 0\n            ? { background: \"#fff\", color: \"#ff6c1a\" }\n            : { background: \"transparent\", color: \"#fff\" }\n        }\n        className=\"btnicon_nav\"\n      >\n        <FontAwesomeIcon icon={faBell} />\n      </button>\n      <span\n        style={\n          notes.view && notes.length > 0\n          ? { color: \"#ff6c1a\" }\n          : { color: \"#fff\" }\n        }\n      >\n        +{notes.items.length}\n      </span>\n      <Popover target=\"note\" isOpen={pop} placement=\"bottom\">\n          <PopoverBody>\n            <ul onClick={handleViewOut}>\n              {\n                notes.items.map(item => (\n                  <li key={uuid()}>\n                    {item.id}\n                  </li>\n                ))\n                }\n            </ul>\n          </PopoverBody>\n        </Popover>\n    </div>\n  )\n}\n\nconst Friend = () => {\n  const friend = useSelector(state => state.nav.notifications.friendReq);\n  const dispatch = useDispatch();\n  const onView = useCallback(()=> {\n    dispatch({ type: ON_VIEW_NAV, note: navView.FRIEND });\n  });\n\n/*  const [list, setList] = useState([]);\n  useEffect(()=> {\n    setList(friend.items);\n  },[friend.items]);*/\n\n  const [pop, setPop] = useState(false);\n  const handleView = () => {\n    onView();\n    setPop(!pop);\n  }\n\n  const handleViewOut = () =>{\n    setPop(false)\n  }\n\n  return(\n    <div className=\"btnicon_cont\">\n      <button\n        id=\"friend\"\n        onClick={handleView}\n        style={\n          friend.view && friend.length > 0\n            ? { background: \"#fff\", color: \"#ff6c1a\" }\n            : { background: \"transparent\", color: \"#fff\" }\n        }\n        className=\"btnicon_nav\"\n      >\n        <FontAwesomeIcon icon={faUser} />\n      </button>\n      <span\n        style={\n          friend.view && friend.length > 0\n          ? { color: \"#ff6c1a\" }\n          : { color: \"#fff\" }\n        }\n      >\n        +{friend.items.length}\n      </span>\n      <Popover target=\"friend\" isOpen={pop} placement=\"bottom\">\n          <PopoverBody>\n            <ul onMouseLeave={handleViewOut}>\n              {\n                friend.items.map(item => (\n                  <li key={uuid()}>\n                    {item.name}\n                  </li>\n                ))\n                }\n            </ul>\n          </PopoverBody>\n        </Popover>\n    </div>\n  )\n}\n\nconst Option = () => {\n  const [pop, setPop] = useState(false);\n  const dispatch = useDispatch();\n  const onLogout = useCallback(async ()=> {\n    try{\n      await axios.get('/user/logout');\n      dispatch({ type: ON_LOGIN, option: false });\n      Router.push('/login');\n    }catch(err){\n      console.log(err);\n    }\n  })\n\n  return(\n    <div className=\"btnicon_cont\">\n      <button id=\"option\" onClick={()=> setPop(!pop)} className=\"btnicon_nav\">\n        <FontAwesomeIcon icon={faCog} />\n      </button>\n      <Popover target=\"option\" isOpen={pop} placement=\"bottom\">\n        <PopoverBody style={{ padding:0 }}>\n          <ul className=\"option_list\" onMouseLeave={()=> setPop(false)}>\n            <li><button>perfil</button></li>\n            <li><button onClick={onLogout}>salir</button></li>\n          </ul>\n        </PopoverBody>\n      </Popover>\n    </div>\n  )\n}\n\nconst Wallet = () => {\n  const wallet = useSelector(state => state.nav.notifications.wallet);\n\n  return (\n  <div className=\"btnicon_cont\">\n    <p className=\"wallet_cont\"><FontAwesomeIcon icon={faCoins} /></p>\n    <span style={{ fontSize: 16 }}>+{wallet}</span>\n  </div>\n  )\n}\n\nconst Notifications = () => {\n\n  return(\n    <ul className=\"notifications_main_cont\">\n      <li><Gift /></li>\n      <li><Note /></li>\n      <li><Friend /></li>\n      <li><Option /></li>\n      <li><Wallet /></li>\n    </ul>\n  );\n}\n\nconst BarLoader = () => {\n  const loader = useSelector(state => state.nav.loader);\n  const dispatch = useDispatch();\n  const onLoader = useCallback((loader)=> dispatch({ type: ON_LOADER, loader }));\n\n  return <div className=\"barloader\" style={{ width: `${loader}%`, opacity: loader > 0 ? 1 : 0 }} />\n}\n\n\nconst Header = () => {\n  const nav = useSelector(state => state.nav);\n  const [width, setWidth] = useState(0);\n  const dispatch = useDispatch();\n  const onNotifications = async () => {\n    try{\n      if(nav.login){\n        const res = await axios.get(`/user/notifications`);\n        dispatch({ type: ON_NOTIFICATIONS, notifications: res.data });\n      }\n    }catch(err){\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    const socket = io();\n    socket.open();\n    socket.on(`nav:${nav.notifications.id}`, (payload) => {\n      let items = nav.notifications[payload.note].items;\n      console.log(items);\n      items = [payload.user, ...nav.notifications[payload.note].items];\n      console.log(items);\n      const reduxPayload = { note: payload.action, items }\n      dispatch({ type: 'ON_NOTE', payload: reduxPayload });\n    });\n    return () => socket.close();\n  },[nav.notifications]);\n\n  useEffect(()=> {\n    onNotifications();\n  },[nav.login]);\n\n  useEffect(()=> {\n    setWidth(window.innerWidth);\n  },[]);\n\n  return(\n    <header className=\"header_main_cont\">\n        <BarLoader />\n        <nav>\n        <DownBar />\n        <div className=\"logo_search\">\n          <Logo url='/' />\n          { nav.login && width > 992 && <SearchBar /> }\n        </div>\n        { !nav.login && <Link href=\"/login\"><button className=\"btn_login\">login</button></Link> }\n        { nav.login && <Notifications /> }\n        </nav>\n        { width < 576 && nav.login && <SearchBar /> }\n    </header>\n  )\n};\n\nexport default Header;\n"]},"metadata":{},"sourceType":"module"}