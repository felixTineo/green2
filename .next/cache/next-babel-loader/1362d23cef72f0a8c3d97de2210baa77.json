{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useReducer } from 'react';\nimport './login.scss';\nimport Layout from '../components/layout/layout';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faGift } from '@fortawesome/free-solid-svg-icons';\nimport Logo from '../components/layout/logo';\nimport { TweenMax } from 'gsap';\nimport axios from 'axios';\nimport { useDispatch } from 'react-redux';\nimport { ON_LOADER } from '../store/actions';\nimport { Popover, PopoverBody } from 'reactstrap';\nimport Router from 'next/router';\nimport { ON_LOGIN } from '../store/actions';\n\nvar LoginForm = function LoginForm(_ref) {\n  var setLogin = _ref.setLogin;\n\n  var _useState = useState(''),\n      mail = _useState[0],\n      setMail = _useState[1];\n\n  var _useState2 = useState(''),\n      pass = _useState2[0],\n      setPass = _useState2[1];\n\n  var _useState3 = useState(false),\n      popMail = _useState3[0],\n      setPopMail = _useState3[1];\n\n  var _useState4 = useState(false),\n      popPass = _useState4[0],\n      setPopPass = _useState4[1];\n\n  var _useState5 = useState(false),\n      active = _useState5[0],\n      setActive = _useState5[1];\n\n  var dispatch = useDispatch();\n\n  var onSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var count, interval, data, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              e.preventDefault();\n              count = 0;\n              setActive(true);\n              interval = setInterval(function () {\n                count = count + 15;\n\n                if (count >= 75) {\n                  clearInterval(interval);\n                  dispatch({\n                    type: ON_LOADER,\n                    loader: 99\n                  });\n                } else {\n                  dispatch({\n                    type: ON_LOADER,\n                    loader: count\n                  });\n                }\n              }, 1000);\n              data = {\n                mail: mail,\n                pass: pass\n              };\n              _context.next = 8;\n              return axios.post('/user/login', data);\n\n            case 8:\n              res = _context.sent;\n              clearInterval(interval);\n\n              if (!(res.data === 'mail')) {\n                _context.next = 14;\n                break;\n              }\n\n              setActive(false);\n              dispatch({\n                type: ON_LOADER,\n                loader: 0\n              });\n              return _context.abrupt(\"return\", setPopMail(true));\n\n            case 14:\n              if (!(res.data === 'pass')) {\n                _context.next = 18;\n                break;\n              }\n\n              setActive(false);\n              dispatch({\n                type: ON_LOADER,\n                loader: 0\n              });\n              return _context.abrupt(\"return\", setPopPass(true));\n\n            case 18:\n              dispatch({\n                type: ON_LOADER,\n                loader: 100\n              });\n              res.data.posts = _JSON$stringify(res.data.posts);\n              res.data.greenPost = _JSON$stringify(res.data.greenPost);\n              Router.replace({\n                pathname: \"/perfil\",\n                query: res.data\n              }, \"/perfil/\".concat(res.data._id), {\n                shallow: true\n              });\n              dispatch({\n                type: ON_LOADER,\n                loader: 100\n              });\n              _context.next = 29;\n              break;\n\n            case 25:\n              _context.prev = 25;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n              dispatch({\n                type: ON_LOADER,\n                loader: 0\n              });\n\n            case 29:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 25]]);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"login_register_cont animated fadeIn\"\n  }, __jsx(\"header\", null, __jsx(\"h1\", null, \"Inicio de sessi\\xF3n\")), __jsx(\"form\", {\n    onSubmit: onSubmit\n  }, __jsx(\"label\", {\n    htmlFor: \"mail\"\n  }, __jsx(\"p\", null, \"usuario\"), __jsx(\"input\", {\n    disabled: active,\n    autoComplete: \"false\",\n    onBlur: function onBlur() {\n      return setPopMail(false);\n    },\n    onFocus: function onFocus() {\n      return setPopMail(false);\n    },\n    id: \"mail\",\n    value: mail,\n    onChange: function onChange(e) {\n      return setMail(e.currentTarget.value);\n    },\n    type: \"text\"\n  }), __jsx(Popover, {\n    isOpen: popMail,\n    target: \"mail\",\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"span\", null, \"El correo no es correcto, por favor verifiquelo e intentelo de nuevo\")))), __jsx(\"label\", {\n    htmlFor: \"pass\"\n  }, __jsx(\"p\", null, \"contrase\\xF1a\"), __jsx(\"input\", {\n    disabled: active,\n    onBlur: function onBlur() {\n      return setPopPass(false);\n    },\n    onFocus: function onFocus() {\n      return setPopPass(false);\n    },\n    id: \"pass\",\n    value: pass,\n    onChange: function onChange(e) {\n      return setPass(e.currentTarget.value);\n    },\n    type: \"password\"\n  }), __jsx(Popover, {\n    isOpen: popPass,\n    target: \"pass\",\n    placement: \"bottom\"\n  }, __jsx(PopoverBody, null, __jsx(\"span\", null, \"El correo no es correcto, por favor verifiquelo e intentelo de nuevo\")))), __jsx(\"footer\", {\n    className: \"login_register_cont\"\n  }, __jsx(\"button\", {\n    disabled: active,\n    onClick: function onClick() {\n      return setLogin(false);\n    },\n    className: \"btn_loogin_register btn_inactive\",\n    type: \"button\"\n  }, \"registro\"), __jsx(\"button\", {\n    disabled: active,\n    className: \"btn_loogin_register btn_active\",\n    type: \"submit\"\n  }, \"login\"))));\n};\n\nvar RegisterForm = function RegisterForm(_ref3) {\n  var setLogin = _ref3.setLogin;\n  var dispatch = useDispatch();\n\n  var _useState6 = useState(),\n      mailPop = _useState6[0],\n      setMailPop = _useState6[1];\n\n  var _useReducer = useReducer(function (state, newState) {\n    return _objectSpread({}, state, newState);\n  }, {\n    name: '',\n    lastName: '',\n    mail: '',\n    pass: '',\n    birthday: '',\n    sex: ''\n  }),\n      values = _useReducer[0],\n      setValues = _useReducer[1];\n\n  var onSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(e) {\n      var count, interval, data, res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              e.preventDefault();\n              count = 0;\n              interval = setInterval(function () {\n                count = count + 15;\n                dispatch({\n                  type: ON_LOADER,\n                  loader: count\n                });\n              }, 1000);\n              data = {\n                name: values.name,\n                lastName: values.lastName,\n                mail: values.mail.toLocaleLowerCase(),\n                pass: values.pass,\n                birthday: values.birthday,\n                sex: values.sex\n              };\n              _context2.next = 7;\n              return axios.post('/user/register', data);\n\n            case 7:\n              res = _context2.sent;\n              clearInterval(interval);\n\n              if (res.data === 'mail') {\n                dispatch({\n                  type: ON_LOADER,\n                  loader: 0\n                });\n                setMailPop(true);\n              } else {\n                dispatch({\n                  type: ON_LOADER,\n                  loader: 100\n                });\n                Router.push({\n                  pathname: \"/perfil?id=\".concat(res.data.id),\n                  query: res.data\n                }, \"/perfil/\".concat(res.data._id));\n              }\n\n              _context2.next = 15;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 12]]);\n    }));\n\n    return function onSubmit(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"register_login_cont animated fadeIn\"\n  }, __jsx(\"header\", null, __jsx(\"h1\", null, \"registro\"), __jsx(\"p\", null, \"Gratis, facil y rapido\")), __jsx(\"form\", {\n    onSubmit: onSubmit\n  }, __jsx(\"div\", {\n    className: \"fullName\"\n  }, __jsx(\"input\", {\n    id: \"name\",\n    type: \"text\",\n    placeholder: \"Nombre\",\n    value: values.name,\n    onChange: function onChange(e) {\n      return setValues({\n        name: e.currentTarget.value\n      });\n    }\n  }), __jsx(\"input\", {\n    style: {\n      marginLeft: \".5rem\"\n    },\n    id: \"lastName\",\n    type: \"text\",\n    placeholder: \"Apellido\",\n    value: values.lastName,\n    onChange: function onChange(e) {\n      return setValues({\n        lastName: e.currentTarget.value\n      });\n    }\n  })), __jsx(\"input\", {\n    id: \"mail\",\n    type: \"text\",\n    placeholder: \"Correo electr\\xF3nico\",\n    value: values.mail,\n    onFocus: function onFocus() {\n      return setMailPop(false);\n    },\n    onChange: function onChange(e) {\n      return setValues({\n        mail: e.currentTarget.value\n      });\n    }\n  }), __jsx(Popover, {\n    placement: \"bottom\",\n    target: \"mail\",\n    isOpen: mailPop\n  }, __jsx(PopoverBody, null, __jsx(\"span\", null, \"El correo ya fue usado para crear otra cuenta\"))), __jsx(\"input\", {\n    id: \"pass\",\n    type: \"password\",\n    placeholder: \"Contrase\\xF1a\",\n    value: values.pass,\n    onChange: function onChange(e) {\n      return setValues({\n        pass: e.currentTarget.value\n      });\n    }\n  }), __jsx(\"div\", {\n    className: \"birth_sex_main\"\n  }, __jsx(\"div\", {\n    className: \"birthday_sex\"\n  }, __jsx(\"p\", null, \"Cumplea\\xF1os\"), __jsx(\"input\", {\n    id: \"birthday\",\n    type: \"date\",\n    placeholder: \"Correo electr\\xF3nico\",\n    value: values.birthday,\n    onChange: function onChange(e) {\n      return setValues({\n        birthday: e.currentTarget.value\n      });\n    }\n  })), __jsx(\"div\", {\n    className: \"birthday_sex\",\n    style: {\n      marginLeft: '1rem'\n    }\n  }, __jsx(\"p\", null, \"Sexo\"), __jsx(\"select\", {\n    onChange: function onChange(e) {\n      return setValues({\n        sex: e.currentTarget.value\n      });\n    },\n    name: \"sex\",\n    id: \"sex\"\n  }, __jsx(\"option\", {\n    value: \"female\"\n  }, \"Mujer\"), __jsx(\"option\", {\n    value: \"male\"\n  }, \"Hombre\"), __jsx(\"option\", {\n    value: \"otro\"\n  }, \"Otro\")))), __jsx(\"footer\", {\n    className: \"login_register_cont\"\n  }, __jsx(\"button\", {\n    className: \"btn_loogin_register btn_active\",\n    type: \"submit\"\n  }, \"registro\"), __jsx(\"button\", {\n    onClick: function onClick() {\n      return setLogin(true);\n    },\n    className: \"btn_loogin_register btn_inactive\",\n    type: \"button\"\n  }, \"login\"))));\n};\n\nvar Login = function Login() {\n  var _useState7 = useState(true),\n      login = _useState7[0],\n      setLogin = _useState7[1];\n\n  return __jsx(Layout, null, __jsx(\"div\", {\n    className: \"login_main_cont\"\n  }, __jsx(\"div\", {\n    className: \"login_cont shadow\"\n  }, __jsx(\"div\", {\n    className: \"green_cont\"\n  }, __jsx(\"header\", null, __jsx(Logo, {\n    url: \"/\"\n  })), __jsx(\"div\", {\n    className: \"green_logo\"\n  }, __jsx(\"h1\", null, __jsx(FontAwesomeIcon, {\n    icon: faGift\n  })), __jsx(\"p\", null, \"Comparte, disfruta... Ayuda el planeta\"), __jsx(\"button\", {\n    type: \"button\"\n  }, \"\\xBFquieres saber mas?\")), __jsx(\"small\", null, \"Comparte con los seres que amas y ayuda a el planeta.\")), login && __jsx(LoginForm, {\n    setLogin: setLogin\n  }), !login && __jsx(RegisterForm, {\n    setLogin: setLogin\n  }))));\n};\n\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}